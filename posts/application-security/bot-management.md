---
title: 'Bot management'
metaDesc: 'Automated traffic coming from bots can be undesirable because they can result in availability issues, increased infrastructure cost, fraud such as account takeover with impact on business.'
socialImage: static-assets/thumbnail-edge.png
---
## Overview
Automated traffic coming from bots can be undesirable because they can result in availability issues, increased infrastructure cost, fraud such as account takeover, and impact on business because of skewed analytics of scraped pricing by competitors. Bot management designates the controls that developers can use to identify traffic coming from bot, and then blocking undesired ones. The nature of such controls will depend on the motivation of the malicious actors behind those bots. The more malicious actors have incentives to target a web application, the more sophisticated controls are needed to detect and block them.

## Signature-based detections for common and pervasive bots
Traffic generated by common and pervasive bots such as scanners and crawlers could be identified and managed on the server side by analyzing the attributes of HTTP requests such as the IP, User-Agent header or TLS fingerprint. AWS WAF allows you to use the following signature based rules:
* Rules based on IP reputation using [Managed IP Reputation rule groups](https://docs.aws.amazon.com/waf/latest/developerguide/aws-managed-rule-groups-ip-rep.html) (Amazon IP reputation list, Anonymous IP list, etc..)
* Rules based on [AWS WAF Bot Control Managed](https://docs.aws.amazon.com/waf/latest/developerguide/waf-bot-control.html) Rule. This rule group gives granularity in terms of how to deal which each bot category such as Http Library or Scraping Framework. 
* Managed rules provided by security partners in the AWS Marketplace, such as [Bot Protection Rules](https://aws.amazon.com/marketplace/pp/prodview-p67737yco45uq) from F5 and [Active Malicious Bots](https://aws.amazon.com/marketplace/pp/prodview-3c3mb3lf7vris) from ThreatSTOP.

These rules can be configured in a very granular way in AWS WAF, such as applying them on specific requests (e.g. identified by path or country), with different action possibilities such as block, challenge, or count but send signals upstream, etc... The following [blog](https://aws.amazon.com/blogs/security/fine-tune-and-optimize-aws-waf-bot-control-mitigation-capability/) gives practical examples of how you can tune AWS WAF Bot Control for your use case.

## Behavioral detections for advanced bots
Some malicious actors have higher incentives for automating traffic to your website, for example because of financial motivation to scrape your content and resell it elsewhere, or to steal credential of legitimate users and make fraudulent transactions using them. They are willing to pay for more advanced evasion techniques such as using residential networks with a large number of IPs, and sophisticated browser automation tools such as Chromium and Puppeteer. For such bots, you need to analyze their behavior with client-side challenges/fingerprinting and server-side aggregated behavior analysis. Watch this [talk](https://www.youtube.com/watch?v=pZ2eftlwZns) to learn about advanced bot detection techniques using AWS WAF. Such detections include Captcha and Account Takeover Prevention.

### Captcha
When you configure rules with AWS WAF, you can se the rule action when it's trigger to send a Captcha challenge. [AWS WAF Captcha](https://docs.aws.amazon.com/waf/latest/developerguide/waf-captcha.html)'s challenges should be fairly easy and quick for humans to complete successfully and hard for computers to either complete successfully or to randomly complete with any meaningful rate of success. 

Check this [demo video](https://www.youtube.com/watch?v=Uo2mrTf4gY8) of Captcha.

### Account Takeover Prevention
Account takeover is an online illegal activity in which an attacker gains unauthorized access to a person's account. The attacker might do this in a number of ways, such as using stolen credentials or guessing the victim's password through a series of attempts. When the attacker gains access, they might steal money, information, or services from the victim. The attacker might pose as the victim to gain access to other accounts that the victim owns, or to gain access to the accounts of other people or organizations. Additionally, they might attempt to change the user's password in order to block the victim from their own accounts. You can monitor and control account takeover attempts by implementing the AWS WAF Fraud Control account takeover prevention (ATP) feature. ATP gives you visibility and control over anomalous login attempts and login attempts that use stolen credentials, to prevent account takeovers that might lead to fraudulent activity. 

ATP sets a unique id in the form of signed cookie for each session that has passed the silent javascript challenge, which requires SDK integration at client side. For each session, ATP monitors the rate of login attempts, from different dimensions to detect for example password or user traversal attempts. In addition, ATP checks user name and password combinations against its stolen credential database, which is updated regularly as new leaked credentials are found on the dark web.

Check this [demo video](https://www.youtube.com/watch?v=adpT3ir_bUY) of ATP.

## Behavioral detections for very advanced bots
Some bots are very advanced, because they are operated by very determined malicious actors such nation state ones. For examples they can use Catcha Farms or Machine Learning to solve Captcha challenges, or they can use farms of emulated mobile phones to bypass client side detections. For such bots, you can use signals from your application to detect abnormal behaviors and block them.

### Application level detections
You can define custom signals from your application to define what is a normal use behavior. For example, [OLX](https://aws.amazon.com/blogs/architecture/field-notes-how-olx-europe-fights-millions-of-bots-with-aws/) automated the detection of advanced bots on their online properties by using two signal sources from their application:
* Amazon Cognito, which is used for user authentication in their websites. When Advanced Security is enabled in Amazon Cognito, Amazon Cognito examines a number of attributes of a user sign-in request to evaluate its risk. For example, it checks whether the user has used the same device before, or has signed in from the same location or IP address. The risk metadata can be consumed in Amazon Cognito Events using a Lambda function. OLX sends high risk events to an Amazon Elasticsearch Cluster.
* New Relic, which is used to monitor their website traffic on the client side. By querying their New Relic logs, OLX is able to detect suspicious behaviors by analyzing aspects like their navigation behavior on their websites.
AWS WAf can be automated to block offending IPs or challenge them further.

Another possibility would be to introduce [Fraud Detector](https://aws.amazon.com/fraud-detector/?nc1=h_ls) to detect abnormal fraudulent behaviors. Fraud Detector uses machine learning (ML) and 20 years of fraud detection expertise from Amazon Web Services (AWS) and Amazon.com to automatically identify potential fraudulent patterns performed by humans and bots at login in real-time. Fraud Detector allows detections of Fraud by analyzing application-level user behavior, using your own historical fraud data to train, test, and deploy custom fraud detection machine learning models tailored to your use case.

To get started with the concept of WAF automation based on signals from the the application, deploy this [AWS Solution](https://aws.amazon.com/fr/solutions/implementations/aws-waf-security-automations/)

### Partners
You can also add a protection layer provided by security vendors on the AWS MArketplace that are specialist in advanced bot detection. Partners include [DataDome](https://aws.amazon.com/marketplace/pp/prodview-ixqmzzcoyin6m), [Distill Networks](https://aws.amazon.com/marketplace/pp/prodview-wmiqvxqu7tr2a), [PerimeterX](https://aws.amazon.com/marketplace/pp/prodview-nqeerttlu2tfq), [Cequence](https://aws.amazon.com/marketplace/pp/prodview-irrpzzlyy4x5a) and [Imperva](https://aws.amazon.com/marketplace/pp/prodview-lphffh7dvo3sw).

Note that each security vendor has different strengths in terms of industry specific protections, capabilities and cost. In general, your application using CloudFront can integrate with them in two different ways:
* They can provide a proxy layer in SaaS mode that sits between CloudFront and your origin. 
* They can provide a globally replicated Bot Mitigation API that can be called by Lambda@Edge for every incoming request (i.e. configured on viewer request event) to decide how to handle the request. Watch this [talk](https://youtu.be/3iknsVpfYr0?t=2108) by DataDome that explains this integration type.


## Additional resources
* TODO